
## Load some libraries
```{r, message=FALSE}
library(maps)
library(mapdata)
library(tidyverse)
library(gridExtra)
```

## Map of Europe and values for AR
```{r}
EU_map <- map_data("world", region=c("Austria","Andorra","Belgium","Bulgaria","Croatia","Cyprus",
                   "Czech Rep.","Denmark","Estonia","Finland","France",
                   "Germany","Greece","Switzerland","Hungary","Italy", "Ireland", "Latvia","Liechtenstein",
                   "Lithuania","Luxembourg","Malta","Netherlands", "Norway","Poland",
                   "Portugal","Romania","Slovakia","Slovenia","Spain",
                   "Sweden", "UK"))

AB_data <- read_delim ("AB_data.txt", delim = "\t", col_names = TRUE)
AR_data <- read_delim("Stare_data.txt", delim=" ", col_names = TRUE)
AR_data$region <- str_replace(AR_data$id_plant, pattern="[:digit:]", replace ="")
AR_data <- AR_data %>% 
  filter(treatmentClassification=="untreated") %>% 
  group_by(region) %>% 
  summarize(ARmean=mean(SUM))

AR_data[AR_data$region=="PT",]$region <- "Portugal"
AR_data[AR_data$region=="CYP",]$region <- "Cyprus"
AR_data[AR_data$region=="FI",]$region <- "Finland"
AR_data[AR_data$region=="DE",]$region <- "Germany"
AR_data[AR_data$region=="NO",]$region <- "Norway"
AR_data[AR_data$region=="ES",]$region <- "Spain"

glimpse(AR_data)

EU_map <- full_join(EU_map, AR_data, by="region")
EU_map <- full_join(EU_map, AB_data, by="region")

glimpse(EU_map)

```

```{r, fig.width=12, fig.height=6}
p1 <- ggplot() + 
  geom_polygon(data = EU_map, aes(x=long, y = lat, group = group, fill=DDD), color="grey40") + 
  scale_y_continuous(limits = c(34,71)) + 
  theme(panel.grid = element_blank(), panel.background = element_blank(),
        plot.title = element_text(size=20, face = "bold")) +
  labs(x="Longitude", y="Latitude", title="A") + scale_fill_gradient(name="AB use", high="red", low="darkgreen", na.value = "grey70")

p2 <- ggplot() + 
  geom_polygon(data = EU_map, aes(x=long, y = lat, group = group, fill=ARmean), color="grey40") + 
  scale_y_continuous(limits = c(34,71)) + 
  theme(panel.grid = element_blank(), panel.background = element_blank(), 
        plot.title = element_text(size=20, face = "bold")) +
  labs(x="Longitude", y="Latitude", title="B") + scale_fill_gradient(name="AR prevalence", high="red", low="darkgreen", na.value = "grey70")
grid.arrange(p1, p2, ncol=2)
```